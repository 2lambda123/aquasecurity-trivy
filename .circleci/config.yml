defaults: &defaults
  docker :
    - image: knqyf263/ci-trivy:latest
  environment:
    CGO_ENABLED: "1"

jobs:
  release:
    <<: *defaults
    steps:
      - checkout
      - run:
          command: |
            goreleaser --rm-dist
      - run:
          command: |
            git clone git@github.com:knqyf263/trivy-repo.git
            cd trivy-repo

workflows:
  version: 2
  release:
    jobs:  
      - release:
          filters:
            branches:
              ignore: /.*/
            tags:
              only: /.*/
