# Cache

## Clear Caches
The `--clear-cache` option removes caches.

**The scan is not performed.**

```
$ trivy image --clear-cache
```

<details>
<summary>Result</summary>

```
2019-11-15T15:13:26.209+0200    INFO    Reopening vulnerability DB
2019-11-15T15:13:26.209+0200    INFO    Removing image caches...
```

</details>

## Cache Directory
Specify where the cache is stored with `--cache-dir`.

```
$ trivy --cache-dir /tmp/trivy/ image python:3.4-alpine3.9
```

## Cache Backend
!!! warning "EXPERIMENTAL"
    This feature might change without preserving backwards compatibility.

Trivy supports local filesystem and Redis as the cache backend. This option is useful especially for client/server mode.

Two options:

- `fs`
    - the cache path can be specified by `--cache-dir`
- `redis://`
    - `redis://[HOST]:[PORT]`
    - TTL can be configured via `--cache-ttl`

```
$ trivy server --cache-backend redis://localhost:6379
```

If you want to use TLS with Redis, you can enable it by specifying the `--redis-tls` flag.

```shell
$ trivy server --cache-backend redis://localhost:6379 --redis-tls
```

Trivy also supports for connecting to Redis with your certificates.
You need to specify `--redis-ca` , `--redis-cert` , and `--redis-key` options.


Trivy supports all Redis deployment options:

- `standalone`
- `sentinel` (in order to connect to a Redis Sentinel, you need to specify the master name with the `-redis-master-name` option)
- `cluster`

```
$ # Redis standalone
$ trivy server --cache-backend redis://localhost:6379

$ # Redis Sentinel
$ trivy server --cache-backend redis://localhost:26379 --redis-master-name mymaster

$ # Redis cluster
$ trivy server -cache-backend redis://redis-0:6379,redis://redis-1:6379,redis://redis-2:6379
```

If your Redis instance requires authentication, the password can be set in the Redis URL (if multiple Redis URLs are specified, the password will be retrieved only from the last Redis URL):

```
trivy server -cache-backend redis://redis-0:6379,redis://redis-1:6379,redis://:password@redis-2:6379
```

Trivy also support for connecting to Redis using TLS, you only need to specify `--redis-ca` , `--redis-cert` , and `--redis-key` option.


```
$ trivy server --cache-backend redis://localhost:6379 \
  --redis-ca /path/to/ca-cert.pem \
  --redis-cert /path/to/cert.pem \
  --redis-key /path/to/key.pem
```
