# Java

## Features
Trivy supports three types of Java scanning: `jar/war/par/ear`, `pom.xml` and `*gradle.lockfile` files.
The following table provides an outline of the features Trivy offers.


| Artifact         |  Maven repository [^1]   | Dev dependencies |
|------------------|:------------------------:|:-----------------|
| jar/war/par/ear  |            ✓             | Include          |
| pom.xml          |            ✓             | Exclude          |
| *gradle.lockfile |            -             | Exclude          |

### Jar
To find information about your jar[^2] file, Trivy parses `pom.properties` and `MANIFEST.MF` files in your jar[^2] file and takes `required properties`[^3].

If those files don't exist or don't contain enough information - Trivy uses [maven repository REST API](https://central.sonatype.org/search/rest-api-guide) to try to get missing information.

!!! Note
    Trivy only takes information about package. We don't take list of vulnerability for package from `maven repository`(Information about data sources for java you can see [here](../detection/data-source.md))


You can disable use of `maven repository REST API`. Use `--offline-scan` flag for this. `--offline-scan` flag doesn't affect Trivy-DB.

!!! Warning
    Trivy may skip some dependencies(that were not found in `pom.properties` or `MANIFEST.MF`) when the `--offline-scan` flag is used.

Base jar[^2] may contain inner jars[^2] within itself. To find information aobut these jars[^2] same logic is used as for base jar[^2].

### Pom.xml
Trivy parses your `pom.xml` file and try to find files with dependencies on your local PC(project folder[^4], relativePath field[^5] and local repository folder[^6]).

If your local PC doesn't have necessary files - Trivy try to find info about these dependencies in [maven repository](https://repo.maven.apache.org/maven2/).

!!! Note
    Trivy only takes information about package. We don't take list of vulnerability for package from `maven repository`(Information about data sources for java you can see [here](../detection/data-source.md))

You can disable connection to maven repository. Use `--offline-scan` flag for this. `--offline-scan` flag doesn't affect Trivy-DB.

!!! Warning
    Trivy may skip some dependencies(that were not found on your local PC) when the `--offline-scan` flag is used.

### Gradle.lock
`gradle.lock` files contain all necessary information about used dependencies. Trivy simply parses this file and finds vulnerabilities for it.

[^1]: Uses maven repository to get information about dependencies. Internet access required.
[^2]: It means `*.jar`, `*.war`, `*.par` and `*.ear` file
[^3]: `ArtifactID`, `GroupID` and `Version`
[^4]: e.g. when parent pom.xml file has `../pom.xml` path
[^5]: When you use dependency path in `relativePath` field in pom.xml file
[^6]: `/Users/<username>/.m2/repository`(for Linux and Mac) and `C:/Users/<username>/.m2/repository(for Windows)` by default