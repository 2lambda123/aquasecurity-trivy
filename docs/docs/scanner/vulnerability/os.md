# OS Packages
Trivy is capable of automatically detecting installed OS packages when scanning container images, VM images and running hosts.
This page provides an overview of OS packages in the context of Trivy scans.

## Supported OS

The unfixed/unfixable vulnerabilities mean that the patch has not yet been provided on their distribution.
To hide unfixed/unfixable vulnerabilities, you can use the `--ignore-unfixed` flag.

Trivy doesn't support self-compiled packages/binaries, but official packages provided by vendors such as Red Hat and Debian.

| OS                               | Supported Versions                  | Target Packages               | Detection of unfixed vulnerabilities |
| -------------------------------- | ----------------------------------- | ----------------------------- | :----------------------------------: |
| Alpine Linux                     | 2.2 - 2.7, 3.0 - 3.18, edge         | Installed by apk              |                  NO                  |
| Wolfi Linux                      | (n/a)                               | Installed by apk              |                  NO                  |
| Chainguard                       | (n/a)                               | Installed by apk              |                  NO                  |
| Red Hat Universal Base Image[^1] | 7, 8, 9                             | Installed by yum/rpm          |                 YES                  |
| Red Hat Enterprise Linux         | 6, 7, 8                             | Installed by yum/rpm          |                 YES                  |
| CentOS                           | 6, 7, 8                             | Installed by yum/rpm          |                 YES                  |
| AlmaLinux                        | 8, 9                                | Installed by yum/rpm          |                  NO                  |
| Rocky Linux                      | 8, 9                                | Installed by yum/rpm          |                  NO                  |
| Oracle Linux                     | 5, 6, 7, 8                          | Installed by yum/rpm          |                  NO                  |
| CBL-Mariner                      | 1.0, 2.0                            | Installed by yum/rpm          |                 YES                  |
| Amazon Linux                     | 1, 2, 2023                          | Installed by yum/rpm          |                  NO                  |
| openSUSE Leap                    | 42, 15                              | Installed by zypper/rpm       |                  NO                  |
| SUSE Enterprise Linux            | 11, 12, 15                          | Installed by zypper/rpm       |                  NO                  |
| Photon OS                        | 1.0, 2.0, 3.0, 4.0                  | Installed by tdnf/yum/rpm     |                  NO                  |
| Debian GNU/Linux                 | 7, 8, 9, 10, 11, 12                 | Installed by apt/apt-get/dpkg |                 YES                  |
| Ubuntu                           | All versions supported by Canonical | Installed by apt/apt-get/dpkg |                 YES                  |
| Distroless[^2]                   | Any                                 | Installed by apt/apt-get/dpkg |                 YES                  |

## Data Sources

| OS            | Source                                 |
| ------------- | -------------------------------------- |
| Arch Linux    | [Vulnerable Issues][arch]              |
| Alpine Linux  | [secdb][alpine]                        |
| Wolfi Linux   | [secdb][wolfi]                         |
| Chainguard    | [secdb][chainguard]                    |
| Amazon Linux  | [Amazon Linux Security Center][amazon] |
| Debian        | [Security Bug Tracker][debian-tracker] |
|               | [OVAL][debian-oval]                    |
| Ubuntu        | [Ubuntu CVE Tracker][ubuntu]           |
| RHEL/CentOS   | [OVAL][rhel-oval]                      |
|               | [Security Data][rhel-api]              |
| AlmaLinux     | [AlmaLinux Product Errata][alma]       |
| Rocky Linux   | [Rocky Linux UpdateInfo][rocky]        |
| Oracle Linux  | [OVAL][oracle]                         |
| CBL-Mariner   | [OVAL][mariner]                        |
| OpenSUSE/SLES | [CVRF][suse]                           |
| Photon OS     | [Photon Security Advisory][photon]     |

### Data source selection
Trivy **only** consumes security advisories from the sources listed in the above table.

As for packages installed from OS package managers (`dpkg`, `yum`, `apk`, etc.), Trivy uses the advisory database from the appropriate **OS vendor**.

For example: for a python package installed from `yum` (Amazon linux), Trivy will only get advisories from [ALAS][amazon].
But for a python package installed from another source (e.g. `pip`), Trivy will get advisories from the `GitLab` and `GitHub` databases.

This advisory selection is essential to avoid getting false positives because OS vendors usually backport upstream fixes, and the fixed version can be different from the upstream fixed version.

### Severity selection
The severity is taken from the selected data source since vendors are more accurate on the impact than upstream.
Using CVE-2023-0464 as an example, while it is rated as "HIGH" in [NVD](NVD-CVE-2023-0464), Red Hat has marked its 'Impact' as ["Low"][CVE-2023-0464].
The severity depends on the compile option, the default configuration, etc.
NVD doesn't know how the vendor distributes the software.
Red Hat evaluates the severity more accurately.
Therefore, Trivy prefers vendor scores over NVD.

When only a CVSS score is provided without a severity rating, the following conversion table is used to translate the CVSS score into a severity level.

|  CVSSv3  | Severity |
| :------: | :------: |
| 0.1-3.9  |   Low    |
| 4.0-6.9  |  Medium  |
| 7.0-8.9  |   High   |
| 9.0-10.0 | Critical |

If the data source does not provide severity and score, it falls back to [NVD][nvd], and if NVD does not have severity, it will be UNKNOWN.


[^1]: https://developers.redhat.com/products/rhel/ubi
[^2]: https://github.com/GoogleContainerTools/distroless

[arch]: https://security.archlinux.org/
[alpine]: https://secdb.alpinelinux.org/
[wolfi]: https://packages.wolfi.dev/os/security.json
[chainguard]: https://packages.cgr.dev/chainguard/security.json
[amazon]: https://alas.aws.amazon.com/
[debian-tracker]: https://security-tracker.debian.org/tracker/
[debian-oval]: https://www.debian.org/security/oval/
[ubuntu]: https://ubuntu.com/security/cve
[rhel-oval]: https://www.redhat.com/security/data/oval/v2/
[rhel-api]: https://www.redhat.com/security/data/metrics/
[alma]: https://errata.almalinux.org/
[rocky]: https://download.rockylinux.org/pub/rocky/
[oracle]: https://linux.oracle.com/security/oval/
[suse]: http://ftp.suse.com/pub/projects/security/cvrf/
[photon]: https://packages.vmware.com/photon/photon_cve_metadata/
[mariner]: https://github.com/microsoft/CBL-MarinerVulnerabilityData/

[nvd]: https://nvd.nist.gov/

[NVD-CVE-2023-0464]: https://nvd.nist.gov/vuln/detail/CVE-2023-0464