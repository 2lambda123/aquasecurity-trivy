package types

import (
	ftypes "github.com/aquasecurity/fanal/types"
	"github.com/aquasecurity/trivy-db/pkg/types"
)

// DetectedVulnerability holds the information of detected vulnerabilities
type DetectedVulnerability struct {
	VulnerabilityID  string       `json:",omitempty"`
	PkgName          string       `json:",omitempty"`
	InstalledVersion string       `json:",omitempty"`
	FixedVersion     string       `json:",omitempty"`
	Layer            ftypes.Layer `json:",omitempty"`
	SeveritySource   string       `json:",omitempty"`

	types.Vulnerability
}

// Less returns is vulnerability is less than other vulnerability
func (v DetectedVulnerability) Less(v2 DetectedVulnerability) bool {
	if v.PkgName != v2.PkgName {
		return v.PkgName < v2.PkgName
	}
	ret := types.CompareSeverityString(
		v2.Severity, v.Severity,
	)
	if ret != 0 {
		return ret > 0
	}
	return v.VulnerabilityID < v2.VulnerabilityID
}
