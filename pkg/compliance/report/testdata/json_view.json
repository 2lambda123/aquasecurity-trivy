{
  "id": "1234",
  "title": "nsa",
  "description": "National Security Agency - Kubernetes Hardening Guidance",
  "severity": "1.0",
  "relatedResources": [
    "http://related-resource/"
  ],
  "results": [
    {
      "id": "1.0",
      "name": "Non-root containers",
      "description": "Check that container is not running as root",
      "severity": "MEDIUM",
      "results": [
        {
          "Target": "Deployment/metrics-server",
          "Class": "config",
          "Type": "kubernetes",
          "MisconfSummary": {
            "Successes": 1,
            "Failures": 0,
            "Exceptions": 0
          },
          "Misconfigurations": [
            {
              "Type": "Kubernetes Security Check",
              "ID": "KSV001",
              "AVDID": "AVD-KSV-0001",
              "Title": "Process can elevate its own privileges",
              "Description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
              "Message": "Container 'metrics-server' of Deployment 'metrics-server' should set 'securityContext.allowPrivilegeEscalation' to false",
              "Namespace": "builtin.kubernetes.KSV001",
              "Query": "data.builtin.kubernetes.KSV001.deny",
              "Resolution": "Set 'set containers[].securityContext.allowPrivilegeEscalation' to 'false'.",
              "Severity": "MEDIUM",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv001",
              "References": [
                "https://kubernetes.io/docs/concepts/security/pod-security-standards/#restricted",
                "https://avd.aquasec.com/misconfig/ksv001"
              ],
              "Status": "FAIL",
              "Layer": {},
              "CauseMetadata": {
                "Provider": "Kubernetes",
                "Service": "general",
                "StartLine": 132,
                "EndLine": 140,
                "Code": {
                  "Lines": [
                    {
                      "Number": 132,
                      "Content": "                - image: rancher/metrics-server:v0.3.6",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 133,
                      "Content": "                  imagePullPolicy: IfNotPresent",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 134,
                      "Content": "                  name: metrics-server",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 135,
                      "Content": "                  resources: {}",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 136,
                      "Content": "                  terminationMessagePath: /dev/termination-log",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 137,
                      "Content": "                  terminationMessagePolicy: File",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 138,
                      "Content": "                  volumeMounts:",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 139,
                      "Content": "                    - mountPath: /tmp",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 140,
                      "Content": "                      name: tmp-dir",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": true
                    }
                  ]
                }
              }
            }
          ]
        }
      ]
    },
    {
      "id": "1.1",
      "name": "Immutable container file systems",
      "description": "Check that container root file system is immutable",
      "severity": "LOW",
      "results": [
        {
          "Target": "Deployment/metrics-server",
          "Class": "config",
          "Type": "kubernetes",
          "MisconfSummary": {
            "Successes": 1,
            "Failures": 0,
            "Exceptions": 0
          },
          "Misconfigurations": [
            {
              "Type": "Kubernetes Security Check",
              "ID": "KSV003",
              "AVDID": "AVD-KSV-0003",
              "Title": "Default capabilities not dropped",
              "Description": "The container should drop all default capabilities and add only those that are needed for its execution.",
              "Message": "Container 'metrics-server' of Deployment 'metrics-server' should add 'ALL' to 'securityContext.capabilities.drop'",
              "Namespace": "builtin.kubernetes.KSV003",
              "Query": "data.builtin.kubernetes.KSV003.deny",
              "Resolution": "Add 'ALL' to containers[].securityContext.capabilities.drop.",
              "Severity": "LOW",
              "PrimaryURL": "https://avd.aquasec.com/misconfig/ksv003",
              "References": [
                "https://kubesec.io/basics/containers-securitycontext-capabilities-drop-index-all/",
                "https://avd.aquasec.com/misconfig/ksv003"
              ],
              "Status": "FAIL",
              "Layer": {},
              "CauseMetadata": {
                "Provider": "Kubernetes",
                "Service": "general",
                "StartLine": 132,
                "EndLine": 140,
                "Code": {
                  "Lines": [
                    {
                      "Number": 132,
                      "Content": "                - image: rancher/metrics-server:v0.3.6",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": true,
                      "LastCause": false
                    },
                    {
                      "Number": 133,
                      "Content": "                  imagePullPolicy: IfNotPresent",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 134,
                      "Content": "                  name: metrics-server",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 135,
                      "Content": "                  resources: {}",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 136,
                      "Content": "                  terminationMessagePath: /dev/termination-log",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 137,
                      "Content": "                  terminationMessagePolicy: File",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 138,
                      "Content": "                  volumeMounts:",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 139,
                      "Content": "                    - mountPath: /tmp",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": false
                    },
                    {
                      "Number": 140,
                      "Content": "                      name: tmp-dir",
                      "IsCause": true,
                      "Annotation": "",
                      "Truncated": false,
                      "FirstCause": false,
                      "LastCause": true
                    }
                  ]
                }
              }
            }
          ]
        }
      ]
    }
  ]
}
